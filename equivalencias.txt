####################################
# La columna func.refGene || func.ensGene es tipo str, se reiterpreta como valores numéricos siguiendo la norma:

exonic = splicing > ncRNA> > UTR5/UTR3 > intron > upstream/downstream > intergenic

Value 	Default precedence 	Explanation 	Sequence Ontology
exonic 	1 	variant overlaps a coding 	exon_variant (SO:0001791)
splicing 	1 	variant is within 2-bp of a splicing junction (use -splicing_threshold to change this) 	splicing_variant (SO:0001568)
ncRNA 	2 	variant overlaps a transcript without coding annotation in the gene definition (see Notes below for more explanation) 	non_coding_transcript_variant (SO:0001619)
UTR5 	3 	variant overlaps a 5' untranslated region 	5_prime_UTR_variant (SO:0001623)
UTR3 	3 	variant overlaps a 3' untranslated region 	3_prime_UTR_variant (SO:0001624)
intronic 	4 	variant overlaps an intron 	intron_variant (SO:0001627)
upstream 	5 	variant overlaps 1-kb region upstream of transcription start site 	upstream_gene_variant (SO:0001631)
downstream 	5 	variant overlaps 1-kb region downtream of transcription end site (use -neargene to change this) 	downstream_gene_variant (SO:0001632)
intergenic 	6 	variant is in intergenic region 	intergenic_variant (SO:0001628)

The first column tells whether the variant hit exons or hit intergenic regions, or hit introns, or hit a non-coding RNA genes. 
If the variant is exonic/intronic/ncRNA, the second column gives the gene name (if multiple genes are hit, comma will be added 
between gene names); if not, the second column will give the two neighboring genes and the distance to these neighboring genes.

the "exonic" here refers only to coding exonic portion , but not UTR portion, as there are two keywords (UTR5, UTR3) that are specifically reserved for UTR annotations.
"splicing" in ANNOVAR is defined as variant that is within 2-bp away from an exon/intron boundary by default, but the threshold can be changed by the --splicing_threshold argument. Before Feb 2013, if "exonic,splicing" is shown, it means that this is a variant within exon but close to exon/intron boundary; this behavior is due to historical reason, when a user requested that exonic variants near splicing sites be annotated with splicing as well. However, I continue to get user emails complaining about this behavior despite my best efforts to put explanation in the ANNOVAR website with details. Therefore, starting from Feb 2013 , "splicing" only refers to the 2bp in the intron that is close to an exon, and if you want to have the same behavior as before, add -exonicsplicing argument.
If a variant is located in both 5' UTR and 3' UTR region (possibly for two different genes), then the "UTR5,UTR3" will be printed as the output.
The term "upstream" and "downstream" is defined as 1-kb away from transcription start site or transcription end site, respectively, taking in account of the strand of the mRNA; the --neargene threshold can be used to adjust this threshold.
If a variant is located in both downstream and upstream region (possibly for 2 different genes), then the "upstream,downstream" will be printed as the output. In 2011 June version of ANNOVAR, the splicing annotation is improved. If the splicing site is in intron, then all isoforms and the corresponding base change will be printed


####################################
# La columna ExonicFunc.refGene || ExonicFunc.ensGene es tipo str, se reiterpreta como valores numéricos siguiendo la norma:

contains the amino acid changes as a result of the exonic variant

Annotation 	Precedence 	Explanation 	Sequence Ontology
frameshift insertion 	1 	an insertion of one or more nucleotides that cause frameshift changes in protein coding sequence 	frameshift_elongation (SO:0001909)
frameshift deletion 	2 	a deletion of one or more nucleotides that cause frameshift changes in protein coding sequence 	frameshift_truncation (SO:0001910)
frameshift block substitution 	3 	a block substitution of one or more nucleotides that cause frameshift changes in protein coding sequence 	frameshift_variant (SO:0001589)
stopgain 	4 	a nonsynonymous SNV, frameshift insertion/deletion, nonframeshift insertion/deletion or block substitution that lead to the immediate creation of stop codon at the variant site. For frameshift mutations, the creation of stop codon downstream of the variant will not be counted as "stopgain"! 	stop_gained (SO:0001587)
stoploss 	5 	a nonsynonymous SNV, frameshift insertion/deletion, nonframeshift insertion/deletion or block substitution that lead to the immediate elimination of stop codon at the variant site 	stop_lost (SO:0001578)
nonframeshift insertion 	6 	an insertion of 3 or multiples of 3 nucleotides that do not cause frameshift changes in protein coding sequence 	inframe_insertion (SO:0001821)
nonframeshift deletion 	7 	a deletion of 3 or mutliples of 3 nucleotides that do not cause frameshift changes in protein coding sequence 	inframe_deletion (SO:0001822)
nonframeshift block substitution 	8 	a block substitution of one or more nucleotides that do not cause frameshift changes in protein coding sequence 	inframe_variant (SO:0001650)
nonsynonymous SNV 	9 	a single nucleotide change that cause an amino acid change 	missense_variant (SO:0001583)
synonymous SNV 	10 	a single nucleotide change that does not cause an amino acid change 	synonymous_variant (SO:0001819)
unknown 	11 	unknown function (due to various errors in the gene structure definition in the database file) 	sequence_variant (SO:0001060)





####################################
# The list of terms currently used by both ClinVar and GTR is reported on GTR's ftp site: ftp://ftp.ncbi.nlm.nih.gov/pub/GTR/standard_terms/Clinical_significance.txt. The following table lists these options for clinical significance for an individual submission (SCV) in ClinVar and  guidance for when each term should be used.

Clinical significance value 	Guidance for use in ClinVar SCV records
Benign 	Asrecommended by ACMG/AMPfor variants interpreted for Mendelian disorders.
Likely benign 	Asrecommended by ACMG/AMP (https://www.ncbi.nlm.nih.gov/pubmed/25741868) for variants interpreted for Mendelian disorders.
Uncertain significance 	Asrecommended by ACMG/AMPfor variants interpreted for Mendelian disorders.
Likely pathogenic 	Asrecommended by ACMG/AMPfor variants interpreted for Mendelian disorders.
Pathogenic 	Asrecommended by ACMG/AMPfor variants interpreted for Mendelian disorders. Variants that have low penetrance may be submitted as "Pathogenic"; please also include information about the penetrance in a "Comment on clinical significance".
drug response 	A general term for a variant that affects a drug response, not a disease. We anticipate adding more specific drug response terms based on arecommendation by CPIC. https://www.pharmgkb.org/page/cpicTermProject
association 	For variants identified in a GWAS study and further interpreted for their clinical significance.
risk factor 	For variants that are interpreted not to cause a disorder but to increase the risk.
protective 	For variants that decrease the risk of a disorder, including infections.
Affects 	For variants that cause a non-disease phenotype, such as lactose intolerance.
conflicting data from submitters 	Only for submissions from a consortium, where groups within the consortium have conflicting intepretations of a variant but provide a single submission to ClinVar.
other 	If ClinVar does not have the appropriate term for your submission, we ask that you submit "other" as clinical significance and contact us to discuss if there are other terms we should add.

not provided
	

For submissions without an interpretation of clinical significance. The primary goal of ClinVar is to archive reports of clinical significance of variants. Therefore submissions with a clinical significance of "not provided" should be limited to:

    "literature only" submissions that report a publication about the variant, without interpreting the clinical significance
    "research" submissions that provide functional significance (e.g. undetectable protein level) but no interpretation of clinical significance
    "clinical testing" or "phenotyping only" submissions from clinics or physicians that provide additional information about individuals with the variant, such as observed phenotypes, but do not interpret the clinical significance

'-' 	This value may not be submitted. It is used in the file variant_summary.txt.gz in the path  ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/tab_delimited/. This file reports  '-' in the ClinicalSignificance column for an allele that was submitted to ClinVar only in combination with another allele (e.g.a submission with an interpretation of a haplotype or a compound heterozygote) and was not interpreted explictly.  ClinVar thus has no interpretation specific to that allele.  To find the the interpretation that includes that allele, you can query ClinVar by the AlleleID,e.g.https://www.ncbi.nlm.nih.gov/clinvar/?term=38420[alleleid].


Tras estudiar la bibliografía disponible y valorar la experiencia y conocimiento sobre el dominio del problema, se decide transformar esta variable en una variable ordinal
siguiendo la tabla expuest a cotinuación:
Puntuacion	Categoría
-1		Bening
-0.75		Lik.Ben, Benign/Lik.Ben
-0.5		protective
0		not provider, other, uncert. signif, conflict. data
0.5		affects,association 
0.75		risk_factor,drug response
0.9		Lik.Pathog
1		Pathogenic, Pathogenic/Lik.Pathog

####################################
# La columna function se trnsforma en ordinal siguinedo la tabla:

stoploss		4
nonsense		4
missense		3
frameshiftInsertion	3
frameshiftDeletion	3
frameshiftBlockSubstitution	3
nonframeshiftInsertion	2
nonframeshiftDeletion	2
nonframeshift		2
synonymous		1
unknown			NaN



####################################
# Grantham score

The Grantham score attempts to predict the distance between two amino acids, in an evolutionary sense. A lower Grantham score reflects less evolutionary distance. A higher Grantham score reflects a greater evolutionary distance. Higher Grantham scores are considered more deleterious:

    The more distant two amino acids are, the less likely the amino acids are to be substituted with one another.

    The more distant two amino acids are, the more damaging is their substitution.

The distance scores published by Grantham range from 5 to 215. A substitution of isoleucine for leucine, or of leucine for isoleucine, has a score of 5 (and is predicted to be tolerated). A substitution cysteine for tryptophan, or of tryptophan for cysteine, has a score of 215. Any variation involving cysteine has a high or very high Grantham score (and is predicted to be deleterious). 
Amino acid replacement is a change from one amino acid to a different amino acid in a protein due to point mutation in the corresponding DNA sequence. It is caused by nonsynonymous missense mutation which changes the codon sequence to code other amino acid instead of the original.

Grantham's distance

Grantham's distance depends on 3 properties: composition, polarity and molecular volume.[4]
https://en.wikipedia.org/wiki/Amino_acid_replacement
Distance difference D for each pair of amino acid i and j is calculated as: D i j = [ α ( c i − c j ) 2 + β ( p i − p j ) 2 + γ ( v i − v j ) 2 ] {\displaystyle D_{ij}=[\alpha (c_{i}-c_{j})^{2}+\beta (p_{i}-p_{j})^{2}+\gamma (v_{i}-v_{j})^{2}]} {\displaystyle D_{ij}=[\alpha (c_{i}-c_{j})^{2}+\beta (p_{i}-p_{j})^{2}+\gamma (v_{i}-v_{j})^{2}]}

where c = composition, p = polarity, and v = molecular volume; and are constants of squares of the inverses of the mean distance for each property, respectively equal to 1.833, 0.1018, 0.000399. According to Grantham's distance, most similar amino acids are leucine and isoleucine and the most distant are cysteine and tryptophan.
Difference D for amino acids[4]
Arg 	Leu 	Pro 	Thr 	Ala 	Val 	Gly 	Ile 	Phe 	Tyr 	Cys 	His 	Gln 	Asn 	Lys 	Asp 	Glu 	Met 	Trp 	
110 	145 	74 	58 	99 	124 	56 	142 	155 	144 	112 	89 	68 	46 	121 	65 	80 	135 	177 	Ser
	102 	103 	71 	112 	96 	125 	97 	97 	77 	180 	29 	43 	86 	26 	96 	54 	91 	101 	Arg
		98 	92 	96 	32 	138 	5 	22 	36 	198 	99 	113 	153 	107 	172 	138 	15 	61 	Leu
			38 	27 	68 	42 	95 	114 	110 	169 	77 	76 	91 	103 	108 	93 	87 	147 	Pro
				58 	69 	59 	89 	103 	92 	149 	47 	42 	65 	78 	85 	65 	81 	128 	Thr
					64 	60 	94 	113 	112 	195 	86 	91 	111 	106 	126 	107 	84 	148 	Ala
						109 	29 	50 	55 	192 	84 	96 	133 	97 	152 	121 	21 	88 	Val
							135 	153 	147 	159 	98 	87 	80 	127 	94 	98 	127 	184 	Gly
								21 	33 	198 	94 	109 	149 	102 	168 	134 	10 	61 	Ile
									22 	205 	100 	116 	158 	102 	177 	140 	28 	40 	Phe
										194 	83 	99 	143 	85 	160 	122 	36 	37 	Tyr
											174 	154 	139 	202 	154 	170 	196 	215 	Cys
												24 	68 	32 	81 	40 	87 	115 	His
													46 	53 	61 	29 	101 	130 	Gln
														94 	23 	42 	142 	174 	Asn
															101 	56 	95 	110 	Lys
																45 	160 	181 	Asp
																	126 	152 	Glu
																		67 	Met 


####################################
# 5000 genomes
nos quedamos con Gmaf porque es global minor allele frequency


####################################
# Tomamos numero mayor. Por encima de 0,5 es patogénico
represernta pvalores



####################################
# phyloP scores measure evolutionary conservation at individual alignment sites. Interpretations of the scores are compared to the evolution that is expected under neutral drift.
Nos quedamos con los valores maximos porque 

    Positive scores — Measure conservation, which is slower evolution than expected, at sites that are predicted to be conserved.

    Negative scores — Measure acceleration, which is faster evolution than expected, at sites that are predicted to be fast-evolving.

phyloP scores are useful to evaluate the signatures of selection at particular nucleotides or classes of nucleotides. For example, as with third codon positions, or first positions of miRNA target sites.

The absolute values of phyloP scores represent –log p-values under a null hypothesis of neutral evolution.

The absolute values of phyloP scores represent –log p-values under a null hypothesis of neutral evolution.

The following range of scores is used in the Ion Reporter™ Software phyloP filter. See phyloP for an explanation of how this range is determined.

    Min — –20

    Max — 30

# Compute conservation or acceleration p-values based on an alignment and
    a model of neutral evolution.  Will also compute p-values of
    conservation/acceleration in a subtree and in its complementary
    supertree given the whole tree (see --subtree).  P-values can be
    produced for entire input alignments (the default), pre-specified
    intervals within an alignment (see --features), or individual sites
    (see --wig-scores and --base-by-base).

    The default behavior is to compute a null distribution for the total
    number of substitutions from the tree model, an estimate of the number
    of substitutions that have actually occurred, and the p-value of this
    estimate wrt the null distribution.  These computations are performed
    as described by Siepel, Pollard, and Haussler (2006).  In addition to
    the SPH method, phyloP can compute p-values or
    conservation/acceleration scores using a likelihood ratio test
    (--method LRT), a score-based test (--method SCORE), or a procedure
    similar to that used by GERP (Cooper et al., 2005) (--method GERP).
    These alternative methods are currently supported only with
    --base-by-base, --wig-scores, or --features.

    The main advantage of the SPH method is that it can provide a complete
    and exact description of distributions over numbers of substitutions.
    However, simulation experiments suggest that the LRT and SCORE methods
    have somewhat better power than SPH for identifying selection,
    especially when the expected number of substitutions is small (e.g.,
    with short branch lengths and/or short intervals/individual sites).
    These two methods are also faster.  They are generally similar to one
    another in power, but in many cases SCORE is considerably faster than
    LRT.  On the other hand, SCORE appears to have slightly less power than
    LRT at low false positive rates, i.e., for cases of extreme selection.
    Thus, when using --base-by-base, --wig-scores, or --features, LRT is
    recommended for most purposes, but SCORE is a good alternative if speed
    is an issue.

    When computing p-values with the SPH method, the default is to use the
    posterior expected number of substitutions as an estimate of the actual
    number.  This is a conservative estimate, because it is biased toward
    the mean of the null distribution by the prior.  These p-values can be
    made less conservative with --fit-model and more conservative with
    --confidence-interval (see below).

 phyloP separately measures conservation at individual columns, ignoring the effects of their neighbors. As a consequence, the phyloP 
plots have a less smooth appearance than the phastCons plots, with more "texture" at individual sites. 
PhyloP is appropriate for evaluating signatures of selection at particular nucleotides or classes of nucleotides 
(e.g., third codon positions, or first positions of miRNA target sites).

Another important difference is that phyloP can measure acceleration (faster evolution than expected under neutral drift) as well as 
conservation (slower than expected evolution). In the phyloP plots, sites predicted to be conserved are assigned positive scores 
(and shown in blue), while sites predicted to be fast-evolving are assigned negative scores (and shown in red). 
The absolute values of the scores represent -log p-values under a null hypothesis of neutral evolution. 



################## 
# NAT, OBDU , IRENE Y LAURA (orden de importancia de primero a ultimo) > a <

Stop Loss	1
Stop Gain	1
nonsense	1

Frameshift insertion	2
frameshift deletion
framshift block substitution	2
splicing	2

nonframeshift insertion	3
nonframeshift deletion	3
nonframshift block substitution	3

nonsynonimous SNP	4
missense	4

synonimous SNV	5






